services:
  ros2:
    container_name: ros2_container
    build:
      context: ros
      dockerfile: Dockerfile
    environment:
      - DISPLAY=${DISPLAY}
      - QT_X11_NO_MITSHM=1
      - ROS_VERSION=2
      - ROS_DISTRO=jazzy
      - ROS_PYTHON_VERSION=3

      - AWS_ACCESS_KEY_ID=''
      - AWS_SECRET_ACCESS_KEY=''
      - AWS_DEFAULT_REGION=ap-south-1
      - AWS_REGION=ap-south-1

      - PORT=8883
      - THING_NAME=test_ros2_thing
      - IOT_POLICY_NAME=ros2_robot_iot_policy

      - IOT_CONFIG_TEMPLATE=/home/ros/templates/iot_config_template.json
      - IOT_POLICY_TEMPLATE=/home/ros/templates/iot_policy_template.json

      - CERT_FOLDER_LOCATION=/home/ros/cert/
      - IOT_CONFIG_FILE=/home/ros/cert/iot_config.json
      - IOT_POLICY_FILE=/home/ros/cert/iot_policy.json
    volumes:
      - /tmp/.X11-unix:/tmp/.X11-unix
      - ./.aws:/root/.aws
      - ./ros:/home/ros
    network_mode: host
    tty: true
    stdin_open: true
    ports:
      - "8883:8883"
    entrypoint: ["bash"]

  frontend:
    container_name: frontend_container
    build:
      context: frontend
      dockerfile: Dockerfile
    ports:
      - "8080:8080"
